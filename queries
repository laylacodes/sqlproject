DROP VIEW Query1;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100

CREATE VIEW QUERY1 AS
SELECT
act.Serial_Nbr,
ad.AD_Type,
ad.AD_Description,
ad.Capacity,
ad.AC_Range,
ad.Capacity - 150 AS Cap_Overage
FROM Aircraft_Data ad, Aircraft_Type act
WHERE act.AD_Type = ad.AD_Type
AND ad.Capacity > 150
ORDER BY act.Serial_Nbr;
TTITLE 'Query 1'
BREAK ON act.Serial_Nbr;
SELECT * FROM Query1;


--
DROP QUERY4;
CREATE VIEW QUERY4 AS
SELECT DISTINCT SF.FLIGHT_DATE, ACT.SERIAL_NBR, AD.AD_TYPE, AD.AD_DESCRIPTION, AD.CAPACITY, AD.AC_RANGE
FROM SCHED_FLIGHT SF CROSS JOIN AIRCRAFT_TYPE ACT
JOIN AIRCRAFT_DATA AD ON (AD.AD_TYPE = ACT.AD_TYPE)
MINUS
SELECT FLIGHT_DATE, SERIAL_NBR, AD_TYPE, AD_DESCRIPTION, CAPACITY, AC_RANGE
FROM SCHED_FLIGHT JOIN AIRCRAFT_TYPE USING(SERIAL_NBR)
JOIN AIRCRAFT_DATA USING(AD_TYPE)
ORDER BY FLIGHt_date;
SELECT * FROM QUERY4;

--

DROP VIEW Query_4_July12;
DROP VIEW Query_4_July13;
DROP VIEW Query_4_July14;
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100

CREATE VIEW Query_4_July12 AS
SELECT 
sf.Flight_Date,
act.AD_Type,
ad.AD_description, 
ad.Capacity, 
ad.AC_range,
act.Serial_NBR
FROM 
Aircraft_Type acr
JOIN Aircraft_Data ad ON act.ad_Type = ad.Ad_Type
JOIN Sched_Flight sf ON  sf.Serial_NBR = act.Serial_NBR
JOIN Flight_Data fd ON fd.Flight_NBR = sf.Flight_NBR
WHERE sf.Flight_Date NOT LIKE '07-12-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_NBR;

CREATE VIEW Query_4_July13 AS
SELECT 
sf.Flight_Date,
act.AD_Type,
ad.AD_description, 
ad.Capacity, 
ad.AD_range,
act.Serial_NBR
FROM 
Aircraft_Type act
JOIN Aircraft_Data ad ON act.AD_Type = ad.AD_Type
JOIN Sched_Flight sf ON  sf.Serial_NBR = act.Serial_NBR
JOIN Flight_Data fd ON fd.Flight_NBR = sf.Flight_NBR
WHERE sf.Flight_Date NOT LIKE '07-13-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_NBR;

CREATE VIEW Query_4_July14 AS
SELECT 
sf.Flight_Date,
act.AD_Type,
ad.AD_description, 
ad.Capacity, 
ad.AD_range,
act.Serial_NBR
FROM 
Aircraft_Type act
JOIN Aircraft_Data ad ON act.AD_Type = ad.AD_Type
JOIN Sched_Flight sf ON  sf.Serial_NBR = act.Serial_NBR
JOIN Flight_Data fd ON fd.Flight_NBR = sf.Flight_NBR
WHERE sf.Flight_Date NOT LIKE '07-14-2000%'
ORDER BY sf.Flight_Date;
BREAK ON act.Serial_NBR;
SELECT * FROM Query_4_July12; 
SELECT * FROM Query_4_July13; 
SELECT * FROM Query_4_July14;

--
DROP VIEW QUERY5;
CREATE VIEW QUERY5 AS
SELECT DISTINCT
v.Flight_Nbr, 
v.Flight_Date, 
v.Cust_Nbr,
v.aprt_code,
v.city_name,
v.dep_time,
v.Dep_Aprt_Code,
fd.arr_aprt_code,
sf.arr_time
FROM 
View2 v
JOIN flight_data fd ON fd.flight_nbr = v.flight_nbr
JOIN sched_flight sf ON sf.flight_nbr = v.flight_nbr
ORDER BY cust_nbr, aprt_code, dep_time;
SELECT * FROM QUERY5;


