--report 1
SELECT
    Serial_nbr,
    type,
    desription,
    capacity,
    range
FROM
    aircraft_data
    LEFT JOIN aircraft_type USING (type)
ORDER BY
    serial_nbr;
    
--report 4
SELECT
    Flight_nbr,
    Flight_date,
    Serial_nbr,
    COUNT (cust_nbr) AS Seats_Booked,
    capacity - COUNT (cust_nbr) AS Seats_Available
FROM
    Sched_flight
    LEFT JOIN reservation USING (Flight_Nbr, Flight_Date)
    LEFT JOIN aircraft_type USING (AC_Serial)
    FULL JOIN aircraft_data USING (AC_Type)
GROUP BY
    Flight_Nbr, Flight_date, Serial_nbr, capacity
ORDER BY
    Flight_Date, Flight_nbr;


--report 6
CREATE VIEW Report_6(Flight_Nbr, Flight_Date, Cust_nbr) AS
SELECT
    Flight_nbr,
    Flight_Date,
    cust_nbr
FROM
    reservation
ORDER BY
    Flight_Nbr, Flight_Date, cust_nbr;

CLEAR COLUMNS
CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF

COLUMN Flight_Nbr HEADING 'Aircraft|Nbr'
COLUMN Flight_Date HEADING 'Flight|Date'
COLUMN cust_nbr HEADING 'Cust|Nbr'
SET LINESIZE 80
SET PAGESIZE 30
TTITLE 'TERRA FIRMA AIRLINES|FLIGHT RESERVATION SUMMARY'
SET FEEDBACK OFF
BREAK ON Flight_Nbr ON Flight_Date

SELECT * FROM Report_6;
