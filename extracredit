-- REPORT 5

CREATE VIEW report5
AS SELECT
Cust_Nbr, 
Cust_Name, 
Flight_Nbr, 
Flight_Date
FROM Customer
LEFT JOIN Reservation using(Cust_Nbr)
JOIN Sched_Flight using(Flight_Nbr, Flight_Date);
CLEAR BREAK 
CLEAR COLUMN
CLEAR COMPUTE
TTITLE OFF
TTITLE 'TERRA FIRMA AIRLINES|CUSTOMER RESERVATION SUMMARY'

BREAK ON report SKIP 1
COLUMN Cust_Nbr FORMAT A25
COLUMN Flight_Nbr FORMAT A10
COLUMN Flight_Date FORMAT A10
COLUMN Cust_Nbr HEADING 'Cust|Nbr'
COLUMN Cust_Name HEADING 'Cust|Name'
COLUMN Flight_Nbr HEADING 'Flight|Nbr'
COLUMN Flight_Date HEADING 'Flight|Date'
COMPUTE COUNT LABEL 'Number of Reservations;' OF Cust_Nbr ON report;

-- QUERY 2

CLEAR COMPUTE
CLEAR BREAK
TTITLE OFF
SET FEEDBACK OFF
SET Pagesize 75
SET Linesize 100

CREATE VIEW QUERY2 AS
SELECT
SF.flight_nbr,
SF.serial_nbr,
SF.flight_date,
ACT.ad_type
FROM
SCHED_FLIGHT sf
JOIN AIRCRAFT_TYPE act ON act.serial_nbr = sf.serial_nbr
WHERE
flight_date = '12-JUL-22' AND
(FLIGHT_NBR = 181 
OR FLIGHT_NBR = 285
OR FLIGHT_NBR = 887
OR FLIGHT_NBR = 950)
ORDER BY FLIGHT_NBR, SERIAL_NBR;

-- INDEX MODIFICATION

CREATE INDEX CUST_NBR_IDX
ON RESERVATION (CUST_NBR);


